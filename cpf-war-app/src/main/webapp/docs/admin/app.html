<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xml:lang="en"><!-- InstanceBegin template="/Templates/DocTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=8,IE=9,IE=10,IE=Edge" />
    
    <!-- InstanceBeginEditable name="doctitle" -->
<title>Business Applications - Administration - CPF</title>
    <script type="text/javascript">
pageId = 'app';
    </script>
<!-- InstanceEndEditable -->

    <link
      href="https://cdn.datatables.net/keytable/1.2.1/css/dataTables.css"
      rel="stylesheet" type="text/css" />
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/cupertino/jquery-ui.css"
      rel="stylesheet" type="text/css" />
    <link href="../../css/prettify.css" rel="stylesheet" type="text/css" />
    <link href="../../css/rs.css" rel="stylesheet" type="text/css" />
    <link href="../../css/bcgov.css" rel="stylesheet" type="text/css" />
    <link href="../../css/cpf.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.12.0/jquery.validate.min.js"></script>
    <script type="text/javascript" src="../../js/prettify.js"></script>
    <script type="text/javascript" src="../../js/rs.js"></script>
    <script type="text/javascript">
$(document).ready(function() {
  prettyPrint();
  setPageId(pageId);
  createToc();
});
	</script>

<!-- InstanceBeginEditable name="head" -->
    <style type="text/css">
td > ul {
  margin: 0px;
}
    </style>
<!-- InstanceEndEditable -->
  </head>
  <body>
    <div class="body">
      <div class="header">
        <div class="headerContent">
          <div class="title">
            Concurrent Processing Framework - Developer Guide
           </div>
        </div>
      </div>
      <div class="columns_2_2">
        <div class="columns_2_1">
          <div>
            <div class="column_2_1">
              <div class="sideNav">
                <div class="sideMenu">
                  <div class="title"><a href="http://www.gov.bc.ca/" title="B.C. Home">B.C. Home</a></div>
                  <ul>
                    <li><a href="../../ws/">Home</a></li>
                    <li id="overviewMenu"><a href="../../docs/">Overview</a></li>
                    <li id="clientMenu"><a href="../client/">Client Development</a><ul>
                      <li id="clientRestMenu"><a href="../client/rest-api/">Client REST API</a></li>
                      <li id="clientJavaMenu"><a href="../client/java-api/">Client Java API</a></li>
                     <!-- <li id="clientJavaMenu"><a href="../docs/client/javascript-api/">Client JavaScript API</a></li>-->
                    </ul></li>
                    <li id="pluginMenu"><a href="../plugin/">Plug-in Development</a><ul>
                      <li id="pluginOverviewMenu"><a href="../plugin/overview.html">Plug-in Overview</a></li>
                      <li id="pluginProjectMenu"><a href="../plugin/mavenProject.html">Plug-in Maven Project</a></li>
                      <li id="pluginAppMenu"><a href="../plugin/businessApplication.html">Plug-in Business Application Class</a></li>
                      <li id="pluginCustomizationMenu"><a href="../plugin/customization.html">Plug-in Customization Properties</a></li>
                      <li id="pluginConfigurationMenu"><a href="../plugin/config.html">Plug-in Configuration Properties</a></li>
                      <li id="pluginSecurityMenu"><a href="../plugin/security.html">Plug-in Security</a></li>
                      <li id="pluginTestingMenu"><a href="../plugin/testing.html">Plug-in Testing</a></li>
                      <li id="pluginJavaMenu"><a href="../plugin/java-api/" title="Plug-in Java API">Plug-in Java API</a></li>
                    </ul></li>
                    <li id="installMenu"><a href="../install/">Installation</a><ul>
                      <li id="dbInstallMenu"><a href="../install/database.html">Database Installation</a></li>
                      <li id="webInstallMenu"><a href="../install/webapp.html">Web Application Installation</a></li>
                    </ul></li>
                    <li id="adminMenu"><a href="../admin/">Administration</a><ul>
                      <li id="moduleMenu"><a href="module.html">Modules</a></li>
                      <li id="appMenu"><a href="app.html">Business Applications</a></li>
                      <li id="configPropertyMenu"><a href="configProperty.html">Config Properties</a></li>
                      <li id="userAccountMenu"><a href="userAccount.html">User Accounts</a></li>
                      <li id="userGroupMenu"><a href="userGroup.html">User Groups</a></li>
                      <li id="userGroupPermissionMenu"><a href="userGroupPermission.html">User Group Permissions</a></li>
                      <li id="jobsMenu"><a href="job.html">Batch Jobs</a></li>
                      <li id="statisticsMenu"><a href="statistics.html">Dashboard Statistics</a></li>
                      <li id="workersMenu"><a href="worker.html">Workers</a></li>
                      <li id="logMenu"><a href="log.html">Log Files &amp; Diagnostics</a></li>
                    </ul></li>
                  </ul>
                  </div>
              </div>
            </div>
            <div class="column_2_2">
              <div class="bodyContainer">
                <div class="breadcrumbs">
                    <div class="breadcrumb">
<ul>
<li><a href="../../ws/">HOME</a></li>
<li><a href="../../docs/">Developer Guide</a></li>
<!-- InstanceBeginEditable name="crumbs" -->
<li><a href="index.html">Administration</a></li>
<li>Business Applications</li>
<!-- InstanceEndEditable -->
</ul>
</div>
                  
                </div>
                <div class="bodyContent">
<!-- InstanceBeginEditable name="body" -->
<div class="title">Business Applications - Administration</div>
<section>
<h1 id="overview">Overview</h1>

<p>Each CPF <a href="module.html">Module</a> can contain one or more business application.
This page describes how to manage those business applications.</p>

<p>In addition to the business application administration pages described here the following pages describe how to
manage items related to a business application.</p>

<ul>
  <li><a href="statistics.html#appList">Business Application Dashboard Statistics</a></li>
  <li><a href="configProperty.html#appList">Business Application Config Properties</a></li>
  <li><a href="job.html#appList">Business Application Jobs</a></li>
</ul>

<section>
<h2 id="fields">Fields</h2>

<p>The following table summarizes the fields used for business applications.<p>

<div class="simpleDataTable">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th id="name">Name</th>
        <td>The name of the module. Used for links and to flag the app for a job.</td>
      </tr>
      <tr>
        <th id="moduleName">Module</th>
        <td>The name of the <a href="module.html">Module</a> the business application is loaded from.</td>
      </tr>
      <tr>
        <th id="title">Title</th>
        <td>The display title shown on the web app for the business application.</td>
      </tr>
      <tr>
        <th id="descriptionUrl">Description Url</th>
        <td>URL to an external page providing more documentation for the module.</td>
      </tr>
      <tr>
        <th id="logLevel">Log Level</th>
        <td>The level log logging ERROR, INFO, DEBUG. ERROR should be used unless
        there is an issue to be diagnosed. INFO and DEBUG generate large log files and slow
        down the application.</td>
      </tr>
      <tr>
        <th id="testModeEnabled">Test Mode Enabled</th>
        <td>Flag indicating if the web services show the test mode fields when submitting a job.</td>
      </tr>
      <tr>
        <th id="batchModePermission">Batch Mode Permission</th>
        <td>The <a href="#permission">permission</a> to restrict access to submission of jobs.</td>
      </tr>
      <tr>
        <th id="instantModePermission">Instant Mode Permission</th>
        <td>The <a href="#permission">permission</a> to restrict access to submission of instant mode requests.</td>
      </tr>
       <tr>
        <th id="geometryFactory">Geometry Factory</th>
        <td>The geometry factory that all geometries will be converted to before execution on the plug-in.</td>
      </tr>
      <tr>
        <th id="validateGeometry">Validate Geometry</th>
        <td>Flag indicating if the geometries should be validated and rejected if invalid before execution by the plug-in.</td>
      </tr>
      <tr>
        <th id="perRequestInputData">Per Request Input Data</th>
        <td>Flag indicating if the plug-in accepts multiple files with each file being a separate
        request or a single structured data file with each record being a separate request.</td>
      </tr>
      <tr>
        <th id="inputDataContentTypes">Input Data Content Types</th>
        <td>The list of MIME types of for the supported input data files.</td>
      </tr>
      <tr>
        <th id="hasGeometryRequestAttribute">Has Geometry Request Attribute</th>
        <td>Flag indicating if the business application accepts a geometry as one of the request parameters.</td>
      </tr>
      <tr>
        <th id="perRequestResultData">Per Request Result Data</th>
        <td>Flag indicating if the plug-in returns a separate file for each request or generates
        a single structured data file with each record being a the result for each request.</td>
      </tr>
      <tr>
        <th id="resultDataContentTypes">Result Data Content Types</th>
        <td>The list of MIME types of for the supported result data file formats.</td>
      </tr>
      <tr>
        <th id="hasCustomizationProperties">Has Customization Properties</th>
        <td>Flag indicating if the plug-in customizes the form or result formats.</td>
      </tr>
      <tr>
        <th id="resultListProperty">Result List Property</th>
        <td>Flag indicating if the plug-in returns more than one result for a single request.</td>
      </tr>
      <tr>
        <th id="hasResultListCustomizationProperties">Has Result List Customization Properties</th>
        <td>Flag indicating if the plug-in has customization properties on a result list property.</td>
      </tr>
      <tr>
        <th id="hasGeometryResultAttribute">Has Geometry Result Attribute</th>
        <td>Flag indicating if the business application returns a geometry as one of the result parameters.</td>
      </tr>
      <tr>
        <th id="maxRequestsPerJob">Max Requests Per Job</th>
        <td>The maximum number of requests that can be submitted in a job. Jobs with more requests
        than the maximum will be rejected.</td>
      </tr>
      <tr id="maxConcurrentRequests">
        <th>Max Concurrent Requests</th>
        <td>The maximum number of execution groups that will be scheduled at a single time. This
        should not be more than the total number of <a href="configProperty.html#workerPoolSize">cpfWorker.maximumPoolSize</a>
        across all workers. If plug-ins use database connections then it should not exceed the
        maximum database connection pool size or connection limits.</td>
      </tr>
      <tr>
        <th id="numRequestsPerWorker">Num Requests Per Worker</th>
        <td>The maximum number of requests that will be set in an execution group to a worker for
        sequential execution. The CPF splits the request into this number of execution groups
        when the job is pre-processed. The goal should be to have execution groups take between
        1-10 seconds to execute on the worker. The balance should be between the size of data
        for an execution group and the execution time. This will help reduce the overhead of the system.
        For example if a request takes 10ms to run a value of 100 would take approximately 1 second
        to run on the worker.</td>
      </tr>
    </tbody>
  </table>
</div>
</section>

<section>
  <h2 id="permission">Permission Strings</h2>
  <p>Permissions are defined using a <a href="http://docs.spring.io/spring-security/site/docs/3.0.x/reference/el-access.html">Spring Security Expression</a>
  that if evaluated to true will grant the user permission.</p>
  
  <p>The simplest permission is uses the <code>hasRole</code> function to see if the user is a member of a CPF
  group. The function takes a single argument that is the CPF group name prefixed by 'ROLE_'. The
  following example grants access to all internal users.</p>
  
  <pre>hasRole('ROLE_BCGOV_INTERNAL')</pre>
  
  <p>The <code>hasAnyRole</code> function will allow access if the user is a member of any of the listed groups. The
  following example grants access to all internal and business users.<p>
    
  <pre>hasAnyRole('ROLE_BCGOV_INTERNAL','ROLE_BCGOV_BUSINESS')</pre>
  
  <p>This could also be written using the <code>or</code> operator.</p>
      
  <pre>hasRole('ROLE_BCGOV_INTERNAL') or hasRole('ROLE_BCGOV_BUSINESS')</pre>
  
  <p>The <code>hasRoleRegex</code> will allow users who have a CPF group that matches the
  <a href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java regular expression</a>.
  The following example matches all CPF groups that start with BCGOV</p>
  
  <pre>hasRoleRegex('ROLE_BCGOV_.*')</pre>
  
  <p>The permission <code>permitAll</code> grants all users permission.</p>
  
  <p>The permission <code>denyAll</code> grants no users permission.</p>
  
</section>

</section>

<section>
<h1 id="management">Business Application Management</h1>

<p>This section describes how to manage business applications.</p>

<p class="note">The user must be in the ADMIN, or ADMIN_MODULE_[MODULE_NAME]_ADMIN groups
to manage business applications. Module admins will only see business applications they are
module admins for.</p>

<section>
<h2 id="list">Business Applications Lists</h2>

<p>The business applications pages contain a scrolling table of the business applications for a module. The contents of this 
table can be filtered by typing at least 3 characters in search box. The table will show business applications where
the name, module or title contain those characters characters (ignoring case).</p>

<section>
<h3 id="allList">All Business Applications List</h3>
<p>The list of all business applications a user has permission for can be viewed using the following steps.</p>

<ol>
  <li>Open the <a href="../../admin/">CPF Admin Application</a>.</li>
  <li>Click the <a href="../../admin/apps/">Business Applications</a> menu item.</li>
</ol>
</section>

<section>
<h3 id="moduleList">Module Business Application List</h3>
<p>The list of business applications for a module can be viewed using the following steps.</p>

<ol>
  <li>Open the <a href="module.html#view">Module View</a> page.</li>
  <li>Click the 'Business Applications' tab.</li>
</ol>
</section>

</section>

<section>
<h2 id="view">View Business Application</h2>

<p>Business Applications can be viewed using the following steps.</p>

<ol>
  <li>Open one of the <a href="list">Business Applications List</a> pages.</li>
  <li>Scroll or search for the business application.</li>
  <li>Click the link in the 'Name' column.</li>
</ol>
</section>

<section>
<h2 id="edit">Edit Business Application</h2>
<p>Business Applications can be edited using the following steps.</p>

<p class="note">Editing a business application will require a manual restart of the module for
the settings to take affect.</p>

<ol>
  <li>Open the <a href="#view">View Business Application</a> page.</li>
  <li>Click the 'Edit button'.</li>
  <li>Edit the field values.<ol>
    <li><a href="#logLevel">Log Level</a></li>
    <li><a href="#testModeEnabled">Test Mode Enabled</a></li>
    <li><a href="#batchModePermission">Batch Mode Permission</a></li>
    <li><a href="#instantModePermission">Instant Mode Permission</a></li>
    <li><a href="#maxRequestsPerJob">Max Requests Per Job</a></li>
    <li><a href="#maxConcurrentRequests">Max Concurrent Requests</a></li>
    <li><a href="#numRequestsPerWorker">Num Requests Per Worker</a></li>
  </ol></li>
  <li>Click the 'Save' button to save changes, 'Revert to Saved' to undo any changes, or 'Cancel' to return to previous page.</li>
</ol>
</section>

</section>
                    <!-- InstanceEndEditable -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="footer">
        <div class="title">Concurrent Processing Framework (v ${project.version})</div>
        <div class="footerMenu">
          <ul>
            <li><a href="http://www2.gov.bc.ca/gov/admin/copyright.page" title="COPYRIGHT">COPYRIGHT</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/disclaimer.page" title="DISCLAIMER">DISCLAIMER</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/privacy.page" title="PRIVACY">PRIVACY</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/accessibility.page" title="ACCESSIBILITY">ACCESSIBILITY</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
<!-- InstanceEnd --></html>
