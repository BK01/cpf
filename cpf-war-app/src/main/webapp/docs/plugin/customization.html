<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xml:lang="en"><!-- InstanceBegin template="/Templates/DocTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=8,IE=9,IE=10,IE=Edge" />
    
    <!-- InstanceBeginEditable name="doctitle" -->
<title>Plug-in Customization Properties - CPF</title>
    <script type="text/javascript">
pageId = 'pluginCustomization';
    </script>
<!-- InstanceEndEditable -->

    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/cupertino/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.datatables.net/plug-ins/9dcbecd42ad/integration/jqueryui/dataTables.jqueryui.css" rel="stylesheet" type="text/css" />
    <link href="../../css/prettify.css" rel="stylesheet" type="text/css" />
    <link href="../../css/rs.css" rel="stylesheet" type="text/css" />
    <link href="../../css/bcgov.css" rel="stylesheet" type="text/css" />
    <link href="../../css/cpf.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/9dcbecd42ad/integration/jqueryui/dataTables.jqueryui.js"></script>
    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.12.0/jquery.validate.min.js"></script>
    <script type="text/javascript" src="../../js/prettify.js"></script>
    <script type="text/javascript" src="../../js/rs.js"></script>
    <script type="text/javascript">
$(document).ready(function() {
  prettyPrint();
  setPageId(pageId);
  createToc();
});
	</script>

<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
  </head>
  <body>
    <div class="body">
      <div class="header">
        <div class="headerContent">
          <div class="title">
            Concurrent Processing Framework - Developer Guide
           </div>
        </div>
      </div>
      <div class="columns_2_2">
        <div class="columns_2_1">
          <div>
            <div class="column_2_1">
              <div class="sideNav">
                <div class="sideMenu">
                  <div class="title"><a href="http://www.gov.bc.ca/" title="B.C. Home">B.C. Home</a></div>
                  <ul>
                    <li><a href="../../ws/">Home</a></li>
                    <li id="overviewMenu"><a href="../../docs/">Overview</a></li>
                    <li id="clientMenu"><a href="../client/">Client Development</a><ul>
                      <li id="clientRestMenu"><a href="../client/rest-api/">Client REST API</a></li>
                      <li id="clientJavaMenu"><a href="../client/java-api/">Client Java API</a></li>
                     <!-- <li id="clientJavaMenu"><a href="../docs/client/javascript-api/">Client JavaScript API</a></li>-->
                    </ul></li>
                    <li id="pluginMenu"><a href="../plugin/">Plug-in Development</a><ul>
                      <li id="pluginOverviewMenu"><a href="overview.html">Plug-in Overview</a></li>
                      <li id="pluginProjectMenu"><a href="mavenProject.html">Plug-in Maven Project</a></li>
                      <li id="pluginAppMenu"><a href="businessApplication.html">Plug-in Business Application Class</a></li>
                      <li id="pluginCustomizationMenu"><a href="customization.html">Plug-in Customization Properties</a></li>
                      <li id="pluginConfigurationMenu"><a href="config.html">Plug-in Configuration Properties</a></li>
                      <li id="pluginSecurityMenu"><a href="security.html">Plug-in Security</a></li>
                      <li id="pluginTestingMenu"><a href="testing.html">Plug-in Testing</a></li>
                      <li id="pluginJavaMenu"><a href="java-api/" title="Plug-in Java API">Plug-in Java API</a></li>
                    </ul></li>
                    <li id="installMenu"><a href="../install/">Installation</a><ul>
                      <li id="dbInstallMenu"><a href="../install/database.html">Database Installation</a></li>
                      <li id="webInstallMenu"><a href="../install/webapp.html">Web Application Installation</a></li>
                    </ul></li>
                    <li id="adminMenu"><a href="../admin/">Administration</a><ul>
                      <li id="moduleMenu"><a href="../admin/module.html">Modules</a></li>
                      <li id="appMenu"><a href="../admin/app.html">Business Applications</a></li>
                      <li id="configPropertyMenu"><a href="../admin/configProperty.html">Config Properties</a></li>
                      <li id="userAccountMenu"><a href="../admin/userAccount.html">User Accounts</a></li>
                      <li id="userGroupMenu"><a href="../admin/userGroup.html">User Groups</a></li>
                      <li id="userGroupPermissionMenu"><a href="../admin/userGroupPermission.html">User Group Permissions</a></li>
                      <li id="jobsMenu"><a href="../admin/job.html">Batch Jobs</a></li>
                      <li id="statisticsMenu"><a href="../admin/statistics.html">Dashboard Statistics</a></li>
                      <li id="workersMenu"><a href="../admin/worker.html">Workers</a></li>
                      <li id="logMenu"><a href="../admin/log.html">Log Files &amp; Diagnostics</a></li>
                    </ul></li>
                  </ul>
                  </div>
              </div>
            </div>
            <div class="column_2_2">
              <div class="bodyContainer">
                <div class="breadcrumbs">
                    <div class="breadcrumb">
<ul>
<li><a href="../../ws/">HOME</a></li>
<li><a href="../../docs/">Developer Guide</a></li>
<!-- InstanceBeginEditable name="crumbs" -->
<li><a href="../../docs/plug-in">Plug-in API</a></li>
<li>Customization Properties</li>
<!-- InstanceEndEditable -->
</ul>
</div>
                  
                </div>
                <div class="bodyContent">
<!-- InstanceBeginEditable name="body" -->
<h1>Customization Properties</h1>

<p>Plug-ins can customize certain aspects of the HTML forms for submitting jobs or how the files
generated by the CPF for structured results.
For example the sections to group fields on the forms or the URL to the style document to be used in
KML documents.</p>

<h2>Defining Customization Properties</h2>

<p>The customization properties can be defined using an optional <code>properties</code> map bean
in the <code>ca.bc.gov.open.cpf.plug-in.sf.xml</code> file.</p>

<p>The map can contain a <code>default</code> entry, or an entry for each business application name.
The value for each entry is a map of the customization properties. If the property is not specified
for a business application then the value from the default entry is used.</p>

<figure>
<pre class="prettyprint">&lt;util:map id=<em>&quot;<b>properties</b>&quot;</em>&gt;
  &lt;entry key=<em>&quot;<b>default</b>&quot;</em>&gt;
   &lt;map&gt;
     &lt;entry
       key=<em>&quot;<b>kmlPlaceMarkNameAttribute</b>&quot;</em>
       value=<em>&quot;<b>fieldA</b>&quot;</em> /&gt;
    &lt;/map&gt;
  &lt;/entry&gt;
  &lt;entry key=<em>&quot;<b>demo</b>&quot;</em>&gt;
   &lt;map&gt;
     &lt;entry
       key=<em>&quot;<b>kmlPlaceMarkNameAttribute</b>&quot;</em>
        value=<em>&quot;<b>fieldB</b>&quot;</em> /&gt;
   &lt;/map&gt;
  &lt;/entry&gt;
&lt;/util:map&gt;</pre>
<figcaption>Example Plug-in Customization Properties</figcaption>
</figure>

<p>Customization properties can also be set by adding a config property for a business application
using the admin web application.</p>

<ol>
  <li>Open the <a href="../../admin/modules/">CPF user secured</a> or <a href="../../secure/admin/modules/">SiteMinder secured</a> CPF modules admin page.</li>
  <li>Click on the name of the module in the table, this will open the module view page.</li>
  <li>Click the Business Applications tab to view the list of business applications.</li>
  <li>Click on the name of the business application in the table, this will open the business application view page.</li>
  <li>Click the Config Properties tab to view the current properties.</li>
  <li>Click the id of a property to view it and then click Edit to change the value or click Add to add a new property.</li>
</ol>

<h2>Form Customization Properties</h2>
<p>The following customization properties are used to define the sections to group fields on the
forms and the default values for fields on the job submission forms.</p>

<div class="simpleDataTable">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>formSectionsOpen</code><br />
        <code>formSectionsOpenInstant</code><br />
        <code>formSectionsOpenSingle</code><br />
        <code>formSectionsOpenMultiple</code></td>
        <td><code>List<String></code></td>
        <td><p>The list of section names that are open on the job submission forms, all other sections will be closed
        by default. The open sections can be specified for all forms using <code>formSectionsOpen</code>
        or for a specific form using <code>formSectionsOpenInstant</code>, <code>formSectionsOpenSingle</code>, or
        <code>formSectionsOpenMultiple</code>. If not specified the open sections will be
        <code>applicationParameters</code>, <code>inputData</code>, and <code>resultFormat</code>.</p>
        <figure>
<pre class="prettyprint">&lt;util:map id="properties"&gt;
  &lt;entry key="demo"&gt;
    &lt;map&gt;
      &lt;entry key="formSectionsOpen"&gt;
        &lt;set&gt;
          &lt;value&gt;applicationParameters&lt;/value&gt;
          &lt;value&gt;inputData&lt;/value&gt;
          &lt;value&gt;resultFormat&lt;/value&gt;
        &lt;/set&gt;
      &lt;/entry&gt;
      &lt;entry key="formSectionsOpenInstant"&gt;
        &lt;set&gt;
          &lt;value&gt;applicationParameters&lt;/value&gt;
          &lt;value&gt;requestParameters&lt;/value&gt;
          &lt;value&gt;resultFormat&lt;/value&gt;
        &lt;/set&gt;
      &lt;/entry&gt;
      &lt;entry key="formSectionsOpenSingle"&gt;
        &lt;set&gt;
          &lt;value&gt;applicationParameters&lt;/value&gt;
          &lt;value&gt;requestParameters&lt;/value&gt;
          &lt;value&gt;resultFormat&lt;/value&gt;
        &lt;/set&gt;
      &lt;/entry&gt;
    &lt;/map&gt;
  &lt;/entry&gt;
&lt;/util:map&gt;</pre>
<figcaption>Example Form Open Sections Customization</figcaption>
</figure></td>
      </tr>
      <tr>
        <td><code>formSectionsMap</code><br />
        <code>formSectionsMapInstant</code><br />
        <code>formSectionsMapSingle</code><br />
        <code>formSectionsMapMultiple</code></td>
        <td><code>List<String></code></td>
        <td><p>This property is used to customize the sections and the fields in each section that
        appear on the job submission forms. The section field can be specified for all forms <code>formSectionsMap</code>
        or for a specific form <code>formSectionsMapInstant</code>, <code>formSectionsMapSingle</code>,
        <code>formSectionsMapMultiple</code>. The property is a <code>map</code> where the <code>key</code>
        on the <code>entry</code> is the name of the section and the value is a <code>list</code>
        of the field names. Section names should be in lowerCamelCase notation. The titles on the sections
        are converted to capitalized words from the section name (e.g. Lower Camel Case). Fields not
        applicable for a form will not be displayed.
        Any business application parameters not listed will be put into the <code>applicationParameters</code> section.
        Any CPF parameters not listed will be in the sections shown below.</p>
        
        <figure>
<pre class="prettyprint">&lt;map&gt;
  &lt;entry key="inputData"&gt;
    &lt;list&gt;
      &lt;value&gt;inputDataContentType&lt;/value&gt;
      &lt;value&gt;inputDataUrl&lt;/value&gt;
      &lt;value&gt;inputData&lt;/value&gt;
      &lt;value&gt;srid&lt;/value&gt;
    &lt;/list&gt;
  &lt;/entry&gt;
  &lt;entry key="resultFormat"&gt;
    &lt;list&gt;
      &lt;value&gt;resultSrid&lt;/value&gt;
      &lt;value&gt;resultDataContentType&lt;/value&gt;
      &lt;value&gt;format&lt;/value&gt;
    &lt;/list&gt;
  &lt;/entry&gt;
  &lt;entry key="resultFormatAdvanced"&gt;
    &lt;list&gt;
      &lt;value&gt;resultNumAxis&lt;/value&gt;
      &lt;value&gt;resultScaleFactorXy&lt;/value&gt;
      &lt;value&gt;resultScaleFactorZ&lt;/value&gt;
    &lt;/list&gt;
  &lt;/entry&gt;
  &lt;entry key="notification"&gt;
    &lt;list&gt;
      &lt;value&gt;notificationEmail&lt;/value&gt;
      &lt;value&gt;notificationUrl&lt;/value&gt;
    &lt;/list&gt;
  &lt;/entry&gt;
  &lt;entry key="testParameters"&gt;
    &lt;list&gt;
      &lt;value&gt;cpfPlug-inTest&lt;/value&gt;
      &lt;value&gt;cpfMinExecutionTime&lt;/value&gt;
      &lt;value&gt;cpfMeanExecutionTime&lt;/value&gt;
      &lt;value&gt;cpfStandardDeviation&lt;/value&gt;
      &lt;value&gt;cpfMaxExecutionTime&lt;/value&gt;
      &lt;value&gt;cpfMeanNumResults&lt;/value&gt;
    &lt;/list&gt;
  &lt;/entry&gt;
&lt;/map&gt;</pre>
<figcaption>Default Form Fields by Section</figcaption>
       </figure>
       
       <figure>
<pre class="prettyprint">&lt;util:map id="properties"&gt;
  &lt;entry key="demo"&gt;
    &lt;map&gt;
      &lt;entry key="formSectionsMapInstant"&gt;
        &lt;map&gt;
          &lt;entry key="jonbParmaters"&gt;
            &lt;list&gt;
              &lt;value&gt;jobParameter1&lt;/value&gt;
            &lt;/list&gt;
          &lt;/entry&gt;
        &lt;/map&gt;
      &lt;/entry&gt;
      &lt;entry key="formSectionsMapSingle"&gt;
        &lt;map&gt;
          &lt;entry key="jonbParmaters"&gt;
            &lt;list&gt;
              &lt;value&gt;jobParameter1&lt;/value&gt;
            &lt;/list&gt;
          &lt;/entry&gt;
        &lt;/map&gt;
      &lt;/entry&gt;
    &lt;/map&gt;
  &lt;/entry&gt;
&lt;/util:map&gt;</pre>
<figcaption>Plug-in Form Fields by Section Customization</figcaption>
        </figure>
        </td>
      </tr>
      <tr>
        <td><code>inputDataContentType</code> or <code>inputDataFileExtension</td>
        <td><code>String</code></td>
        <td><p>The default value shown on forms for Input Data Content Type which is the MIME type or file extension of the input data specified by an inputData or inputDataUrl parameter.</p></td>
      </tr>
      <tr>
        <td><code>srid</code></td>
        <td><code>int</code></td>
        <td><p>The default value shown on forms for Srid which is the EPSG coordinate system code of the source geometry.</p></td>
      </tr>
      <tr>
        <td><code>resultDataContentType</code> or <code>resutDataFileExtension</td>
        <td><code>String</code></td>
        <td><p>The default value shown on forms for Result Data Content Type which is the MIME type or file extension of the result data specified by an resutData or resutDataUrl parameter.</p></td>
      </tr>
      <tr>
        <td><code>resultSrid</code></td>
        <td><code>int</code></td>
        <td><p>The default value shown on forms for Result Coordinate System which is the EPSG coordinate system code used for the result geometry.</p></td>
      </tr>
      <tr>
        <td><code>resultNumAxis</code></td>
        <td><code>int</code></td>
        <td><p>The default value shown on forms for Result Num Axis which is the number of coordinate axis in the result geometry (e.g. 2 for 2D or 3 for 3D).</p></td>
      </tr>
      <tr>
        <td><code>resultScaleFactorXy</code></td>
        <td><code>double</code></td>
        <td><p>The default value shown on forms for Result Scale Factor Xy which is the scale factor to apply the x, y coordinates. The scale factor is 1 / minimum unit. For example if the minimum unit was 1mm (0.001) the scale factor is 1000 (1 / 0.001).</p></td>
      </tr>
      <tr>
        <td><code>resultScaleFactorZ</code></td>
        <td><code>double</code></td>
        <td><p>The default value shown on forms for Result Scale Factor Z which is the scale factor to apply the z coordinates. The scale factor is 1 / minimum unit. For example if the minimum unit was 1mm (0.001) the scale factor is 1000 (1 / 0.001).</p></td>
      </tr>
    </tbody>
  </table>
</div>

<h2>Result File Customization Properties</h2>

<p>The following customization properties are supported.</p>

<div class="simpleDataTable">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>kmlDocumentName</code></td>
        <td><code>String</code></td>
        <td><p>The text to use as the name of the KML Document. <b>NOTE: Don't use on a per result basis.</b></p></td>
      </tr>
      <tr>
        <td><code>kmlDocumentDescription</code></td>
        <td><code>String</code></td>
        <td><p>The text to use as the description of the KML Document. <b>NOTE: Don't use on a per result basis.</b></p></td>
      </tr>
      <tr>
        <td><code>kmlStyle</code></td>
        <td><code>String</code></td>
        <td><p>A list of one or more KML Style tags containing a custom style for the whole document. <b>NOTE: Don't use on a per result basis.</b> External styles should be preferred.</p></td>
      </tr>
      <tr>
        <td><code>kmlPlacemarkDescription</code></td>
        <td><code>String</code></td>
        <td><p>The text to use as the description of the KML Placemark created for each result.</p></td>
      </tr>
      <tr>
        <td><code>kmlPlaceMarkNameAttribute</code></td>
        <td><code>String</code></td>
        <td><p>The name result attribute to use as the Name of the KML Placemark created for each result.</p></td>
      </tr>
      <tr>
        <td><code>kmlSnippet</code></td>
        <td><code>String</code></td>
        <td><p>The text to use as the snippet of the KML Placemark created for each result.</p></td>
      </tr>
      <tr>
        <td><code>kmlStyleUrl</code></td>
        <td><code>String</code></td>
        <td><p>The text to use as the styleUrl of the KML Placemark created for each result.</p></td>
      </tr>
      <tr>
        <td><code>kmlWriteNulls</code></td>
        <td><code>boolean</code></td>
        <td><p>Flag indicating if attributes will null values are to be included in the KML document.
        By default attributes with null values are NOT included in the extended data. If true then
        the attribute will be included as a &;tlvalue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" /&gt; tag.</p></td>
      </tr>
      <tr>
        <td><code>kmlLookAtRange</code></td>
        <td><code>double</code></td>
        <td><p>The range to include in the look at element. If omitted then it will be calculated
        from the geometry. The calculation for points always returns 1000.</p></td>
      </tr>
      <tr>
        <td><code>kmlLookAtMinRange</code></td>
        <td><code>double</code></td>
        <td><p>The minimum value for the range to include in the look at element. This value is used
        if the kmlLookAtRange or calculated range is less than this value.</p></td>
      </tr>
      <tr>
        <td><code>kmlLookAtMaxRange</code></td>
        <td><code>double</code></td>
        <td><p>The maximum value for the range to include in the look at element. This value is used
        if the kmlLookAtRange or calculated range is greater than this value.</p></td>
      </tr>
    </tbody>
  </table>
</div>

<p>See the <a href="https://developers.google.com/kml/documentation/kmlreference">kml reference guide</a> for details on how to use the KML attributes.</p>

<p>Result file customization properties can also be specified on a plug-in class or on the result object
for plug-ins that return a list of results. This allows the property to be calculated for
each result. For example the <code>kmlStyleUrl</code> may vary based on the type of result.
The following example show the optional method that must be implemented for plug-ins that
wish to define per result configuration properties.</p>

<figure>
<pre class="prettyprint">public Map&lt;String,Object&gt; getCustomizationProperties() {
  Map&lt;String,Object&gt; properties = new HashMap&lt;String,Object&gt;();
  // properties.put(&quot;&lt;propertyName&gt;&quot;, &lt;propertyValue&gt;);
  /* For example */
  String styleId = &quot;&lt;Calculated from some field on object&gt;&quot;;
  properties.put(&quot;kmlStyleUrl&quot;, "http://gov.bc.ca/kmlStyle.kml#" + styleId);
  return properties;
}</pre>
<figcaption>Example Plug-in Result Customization Properties</figcaption>
</figure>

<div class="pageNavigation">
  <table>
    <tr>
      <td class="previous"><a href="businessApplication.html">&lt; Previous - Business Application Class</a></td>
      <td class="home"><a href="./">Home</a></td>
      <td class="next"><a href="config.html">Configuration Properties - Next &gt;</a></td>
    </tr>
  </table>
</div>

<!-- InstanceEndEditable -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="footer">
        <div class="title">Concurrent Processing Framework (v ${project.version})</div>
        <div class="footerMenu">
          <ul>
            <li><a href="http://www2.gov.bc.ca/gov/admin/copyright.page" title="COPYRIGHT">COPYRIGHT</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/disclaimer.page" title="DISCLAIMER">DISCLAIMER</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/privacy.page" title="PRIVACY">PRIVACY</a></li>
            <li><a href="http://www2.gov.bc.ca/gov/admin/accessibility.page" title="ACCESSIBILITY">ACCESSIBILITY</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
<!-- InstanceEnd --></html>
