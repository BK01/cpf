<?xml version="1.0" encoding="UTF-8"?>
<beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:p="http://www.springframework.org/schema/p"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
  "
>

  <bean
    id="ca.bc.gov.open.cpf.plugin.api.BusinessApplication-htmlbuilder"
    class="ca.bc.gov.open.cpf.api.web.builder.BusinessApplicationUiBuilder"
  >
    <property name="pages">
      <list>
        <bean
          p:name="list"
          class="com.revolsys.ui.web.config.Page"
          p:title="Business Applications"
          p:path="/admin/apps/"
          p:permission="hasRole('ROLE_ADMIN') or hasRoleRegex('ROLE_ADMIN_MODULE_.*_ADMIN')" />

        <bean
          p:name="moduleList"
          class="com.revolsys.ui.web.config.Page"
          p:title="Business Applications"
          p:path="/admin/modules/{moduleName}/apps/"
          p:permission="hasRole('ROLE_ADMIN')  or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />

        <bean
          p:name="moduleView"
          class="com.revolsys.ui.web.config.Page"
          p:title="Business Application {businessApplicationName}"
          p:path="/admin/modules/{moduleName}/apps/{businessApplicationName}/" />

        <bean
          p:name="moduleEdit"
          class="com.revolsys.ui.web.config.Page"
          p:title="Edit Business Application {businessApplicationName}"
          p:path="/admin/modules/{moduleName}/apps/{businessApplicationName}/edit/" />

        <bean
          p:name="clientList"
          class="com.revolsys.ui.web.config.Page"
          p:title="Business Applications"
          p:path="/ws/apps" />

        <bean
          p:name="clientView"
          class="com.revolsys.ui.web.config.Page"
          p:path="/ws/apps/{businessApplicationName}/{businessApplicationVersion}/" />

        <bean
          p:name="clientInstant"
          class="com.revolsys.ui.web.config.Page"
          p:path="/ws/apps/{businessApplicationName}/{businessApplicationVersion}/instant/" />

        <bean
          p:name="clientSingle"
          class="com.revolsys.ui.web.config.Page"
          p:path="/ws/apps/{businessApplicationName}/{businessApplicationVersion}/single/" />

        <bean
          p:name="clientMultiple"
          class="com.revolsys.ui.web.config.Page"
          p:path="/ws/apps/{businessApplicationName}/{businessApplicationVersion}/multiple/" />
      </list>
    </property>

    <property name="serializers">
      <list>
        <bean
          p:name="name_link"
          class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
          p:key="name"
          p:pageName="moduleView"
        >
          <property name="parameterKeys">
            <map>
              <entry
                key="businessApplicationName"
                value="name" />
              <entry
                key="moduleName"
                value="module.name" />
            </map>
          </property>
        </bean>
        <bean
          class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
          p:name="module.name"
          p:label="Module"
          p:pageName="view" />
        <bean
          class="com.revolsys.ui.html.serializer.key.UnorderedListKeySerializer"
          p:name="compatibleVersions" />
        <bean
          class="com.revolsys.ui.html.serializer.key.MapTableKeySerializer"
          p:name="inputDataContentTypes"
          p:keyLabel="MIME Type"
          p:valueLabel="Description" />
        <bean
          class="com.revolsys.ui.html.serializer.key.MapTableKeySerializer"
          p:name="resultDataContentTypes"
          p:keyLabel="MIME Type"
          p:valueLabel="Description" />
      </list>
    </property>
    <property name="fields">
      <map>
        <entry key="logLevel">
          <bean
            class="com.revolsys.ui.html.fields.SelectField"
            p:name="logLevel"
            p:required="true"
          >
            <property name="options">
              <map>
                <entry
                  key="ERROR"
                  value="ERROR" />
                <entry
                  key="INFO"
                  value="INFO" />
                <entry
                  key="DEBUG"
                  value="DEBUG" />
              </map>
            </property>
          </bean>
        </entry>
        <entry key="batchModePermission">
          <bean
            class="com.revolsys.ui.html.fields.SpelExpressionField"
            p:name="batchModePermission"
            p:required="true" />
        </entry>
        <entry key="instantModePermission">
          <bean
            class="com.revolsys.ui.html.fields.SpelExpressionField"
            p:name="instantModePermission"
            p:required="true" />
        </entry>
        <entry key="maxRequestsPerJob">
          <bean
            class="com.revolsys.ui.html.fields.IntegerField"
            p:name="maxRequestsPerJob"
            p:required="true" />
        </entry>
        <entry key="maxConcurrentRequests">
          <bean
            class="com.revolsys.ui.html.fields.IntegerField"
            p:name="maxConcurrentRequests"
            p:required="true" />
        </entry>
        <entry key="numRequestsPerWorker">
          <bean
            class="com.revolsys.ui.html.fields.IntegerField"
            p:name="numRequestsPerWorker"
            p:required="true" />
        </entry>
      </map>
    </property>

    <property name="views">
      <map>
        <entry key="list">
          <list>
            <value>name_link</value>
            <bean
              class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
              p:name="module.name"
              p:label="Module"
              p:pageName="view" />
            <value>title</value>
            <value>version</value>
          </list>
        </entry>

        <entry key="moduleList">
          <list>
            <bean
              class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
              p:name="name"
              p:pageName="moduleView" />
            <bean
              class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
              p:name="module.name"
              p:label="Module"
              p:pageName="view" />
            <value>title</value>
            <value>version</value>
          </list>
        </entry>

        <entry key="moduleView">
          <list>
            <value>name</value>
            <value>module.name</value>
            <value>title</value>
            <value>descriptionUrl</value>
            <value>version</value>
            <value>compatibleVersions</value>

            <value>logLevel</value>

            <value>batchModePermission</value>
            <value>instantModePermission</value>

            <value>geometryFactory</value>
            <value>validateGeometry</value>

            <value>perRequestInputData</value>
            <value>inputDataContentTypes</value>
            <value>hasGeometryRequestAttribute</value>

            <value>perRequestResultData</value>
            <value>resultDataContentTypes</value>
            <value>resultListProperty</value>
            <value>hasGeometryResultAttribute</value>

            <value>maxRequestsPerJob</value>
            <value>maxConcurrentRequests</value>
            <value>numRequestsPerWorker</value>
          </list>
        </entry>
        <entry key="clientList">
          <list>
            <bean
              class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
              p:name="title"
              p:pageName="clientView"
              p:label="Name"
            >
              <property name="parameterKeys">
                <map>
                  <entry
                    key="businessApplicationName"
                    value="name" />
                  <entry
                    key="businessApplicationVersion"
                    value="version" />
                </map>
              </property>
              <property name="properties">
                <map>
                  <entry
                    key="width"
                    value="200px" />
                </map>
              </property>
            </bean>
            <value>version</value>
            <value>description</value>
          </list>
        </entry>
      </map>
    </property>

    <property name="keyLists">
      <map>
        <entry key="moduleEdit">
          <list>
            <value>logLevel</value>

            <value>batchModePermission</value>
            <value>instantModePermission</value>

            <value>maxRequestsPerJob</value>
            <value>maxConcurrentRequests</value>
            <value>numRequestsPerWorker</value>
          </list>
        </entry>
      </map>
    </property>
  </bean>
</beans>
