<?xml version="1.0" encoding="UTF-8"?>
<beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:p="http://www.springframework.org/schema/p"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
  "
>

  <bean
    id="ca.bc.gov.open.cpf.plugin.impl.module.Module-htmlbuilder"
    class="ca.bc.gov.open.cpf.api.web.builder.ModuleUiBuilder"
    p:mavenRepository-ref="mavenRepository"
    p:moduleLoader-ref="configPropertyModuleLoader"
  >
    <property name="pages">
      <list>
        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="list"
          p:title="Modules"
          p:path="/admin/modules/" />
        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="view"
          p:title="Module {moduleName}"
          p:path="/admin/modules/{moduleName}/" />
        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="add"
          p:title="Add Module"
          p:path="/admin/modules/add/"
          p:permission="hasRole('ROLE_ADMIN')  or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />
        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="edit"
          p:title="Edit Module"
          p:path="/admin/modules/{moduleName}/edit/"
          p:permission="hasRole('ROLE_ADMIN')  or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />

        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="delete"
          p:title="Delete Module"
          p:path="/admin/modules/{moduleName}/delete/"
          p:permission="hasRole('ROLE_ADMIN')" />

        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="stop"
          p:title="Stop Module"
          p:path="/admin/modules/{moduleName}/stop/"
          p:permission="hasRole('ROLE_ADMIN') or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />

        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="start"
          p:title="Start Module"
          p:path="/admin/modules/{moduleName}/start/"
          p:permission="hasRole('ROLE_ADMIN') or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />

        <bean
          class="com.revolsys.ui.web.config.Page"
          p:name="restart"
          p:title="Restart Module"
          p:path="/admin/modules/{moduleName}/restart/"
          p:permission="hasRole('ROLE_ADMIN') or hasRole('ROLE_ADMIN_MODULE_' + #moduleName + '_ADMIN')" />
      </list>
    </property>
    <property name="serializers">
      <list>
        <bean
          p:name="name_link"
          class="com.revolsys.ui.html.serializer.key.PageLinkKeySerializer"
          p:key="name"
          p:label="Name"
          p:pageName="view" />
        <bean
          p:name="enabled"
          class="com.revolsys.ui.html.serializer.key.BooleanImageKeySerializer" />
        <bean
          p:name="started"
          class="com.revolsys.ui.html.serializer.key.BooleanImageKeySerializer" />
        <bean
          p:name="applicationsLoaded"
          class="com.revolsys.ui.html.serializer.key.BooleanImageKeySerializer" />
        <bean
          p:name="startedDate"
          p:label="Start Time"
          class="com.revolsys.ui.html.serializer.key.DateFormatKeySerializer" />
        <bean
          p:name="actions"
          class="com.revolsys.ui.html.serializer.key.MultipleKeySerializer"
        >
          <property name="serializers">
            <list>
              <bean
                class="com.revolsys.ui.html.serializer.key.ActionFormKeySerializer"
                p:name="start"
                p:label="Start"
                p:enabledExpression="enabled and !started"
              >
                <property name="parameterNameMap">
                  <map>
                    <entry
                      key="moduleName"
                      value="name" />
                  </map>
                </property>
              </bean>
              <bean
                class="com.revolsys.ui.html.serializer.key.ActionFormKeySerializer"
                p:name="restart"
                p:label="Restart"
                p:enabledExpression="enabled and started"
              >
                <property name="parameterNameMap">
                  <map>
                    <entry
                      key="moduleName"
                      value="name" />
                  </map>
                </property>
              </bean>
              <bean
                class="com.revolsys.ui.html.serializer.key.ActionFormKeySerializer"
                p:name="stop"
                p:label="Stop"
                p:enabledExpression="enabled and started"
              >
                <property name="parameterNameMap">
                  <map>
                    <entry
                      key="moduleName"
                      value="name" />
                  </map>
                </property>
              </bean>
              <bean
                class="com.revolsys.ui.html.serializer.key.ActionFormKeySerializer"
                p:name="delete"
                p:label="Delete"
              >
                <property name="parameterNameMap">
                  <map>
                    <entry
                      key="moduleName"
                      value="name" />
                  </map>
                </property>
              </bean>
            </list>
          </property>
        </bean>
      </list>
    </property>
    <property name="views">
      <map>
        <entry key="list">
          <list>
            <value>name_link</value>
            <value>status</value>
            <value>enabled</value>
            <value>started</value>
            <value>actions</value>
          </list>
        </entry>
        <entry key="view">
          <list>
            <value>name</value>
            <value>moduleDescriptor</value>
           <value>status</value>
             <value>enabled</value>
            <value>started</value>
            <value>startedDate</value>
            <value>moduleError</value>
            <value>actions</value>
          </list>
        </entry>
      </map>
    </property>
  </bean>
</beans>
